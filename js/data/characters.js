import { ROLE_TEMPLATES, DEFAULT_ITEMS, CHARACTER_ABILITIES } from './characterTemplates.js';
import { MONSTER_TEMPLATES, MONSTER_ACTIVATIONS, MONSTER_ABILITIES } from './monsterTemplates.js';

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤
function getBaseItems(roleTemplate, defaultItems) {
    return {
        inventory: [...roleTemplate.baseInventory, `$${defaultItems.money}`],
        spells: [...(roleTemplate.baseSpells || []), ...(defaultItems.spells || [])],
        items: [...(roleTemplate.baseItems || []), ...(defaultItems.items || [])]
    };
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–æ–≤
function mergeItems(baseItems, configItems) {
    return {
        inventory: [...baseItems.inventory, ...(configItems.inventory || [])],
        spells: [...baseItems.spells, ...(configItems.spells || [])],
        items: [...baseItems.items, ...(configItems.items || [])]
    };
}

// –§–∞–±—Ä–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
function createCharacter(config) {
    const roleTemplate = ROLE_TEMPLATES[config.roleType];
    const defaultItems = DEFAULT_ITEMS[config.roleType.toLowerCase()];
    
    if (!roleTemplate) {
        console.error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø —Ä–æ–ª–∏: ${config.roleType}`);
        return null;
    }

    const baseItems = getBaseItems(roleTemplate, defaultItems);
    const items = mergeItems(baseItems, config);

    return {
        name: config.name,
        role: config.role,
        stats: { ...roleTemplate.stats, ...config.stats },
        ability: config.ability,
        ...items
    };
}

// –§–∞–±—Ä–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–Ω—Å—Ç—Ä–∞
function createMonster(config) {
    const template = MONSTER_TEMPLATES[config.monsterType];
    
    if (!template) {
        console.error(`–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –º–æ–Ω—Å—Ç—Ä–∞: ${config.monsterType}`);
        return null;
    }

    return {
        name: config.name,
        health: config.health || template.baseHealth,
        attackMod: config.attackMod || template.baseAttackMod,
        activation: config.activation,
        abilities: [
            ...template.baseAbilities,
            ...(config.abilities || [])
        ]
    };
}

// –î–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç–æ–≤
export const items = {
    '–ó–∞—â–∏—Ç–∞ –ø–ª–æ—Ç–∏': {
        type: '–ó–∞–∫–ª–∏–Ω–∞–Ω–∏–µ ‚Äî —á–∞—Ä—ã',
        description: '–†–∞–∑ –≤ —Ä–∞—É–Ω–¥, –µ—Å–ª–∏ –≤—ã, –¥—Ä—É–≥–æ–π —Å—ã—â–∏–∫ –∏–ª–∏ —Å–æ—é–∑–Ω–∏–∫ –≤ –ª—é–±–æ–π –æ–±–ª–∞—Å—Ç–∏ –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∏—Ç—å —É—Ä–æ–Ω, –≤—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É üí™. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ —É—Ä–æ–Ω –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ, —Ä–∞–≤–Ω–æ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É –ø—Ä–æ–≤–µ—Ä–∫–∏.'
    },
    '–ë—É—Ä—è –¥—É—Ö–æ–≤': {
        type: '–ó–∞–∫–ª–∏–Ω–∞–Ω–∏–µ ‚Äî —á–∞—Ä—ã',
        description: '–í—ã –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É üí™ –≤–º–µ—Å—Ç–æ üéØ –≤ —Ä–∞–º–∫–∞—Ö –¥–µ–π—Å—Ç–≤–∏—è ¬´–∞—Ç–∞–∫–∞¬ª, –∏—Å–ø–æ–ª—å–∑—É—è –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∞—Ç–∞–∫–∏ –º–æ–Ω—Å—Ç—Ä–∞.'
    },
    '–ì–∏–ø–µ—Ä–±–æ—Ä–µ–π—Å–∫–∞—è —Ä–µ–ª–∏–∫–≤–∏—è': {
        type: '–í–µ—â—å ‚Äî –≤–æ–ª—à–µ–±–Ω–∞—è, –¥–∏–∫–æ–≤–∏–Ω–Ω–∞—è',
        description: '–ü—Ä–æ—á–∏—Ç–∞–≤ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ, –≤—ã –º–æ–∂–µ—Ç–µ —É–ª—É—á—à–∏—Ç—å 1 –Ω–∞–≤—ã–∫ –ø–æ —Å–≤–æ–µ–º—É –≤—ã–±–æ—Ä—É.'
    },
    '–ú–æ—Ç–æ—Ü–∏–∫–ª': {
        type: '–í–µ—â—å ‚Äî —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç',
        description: '–í–º–µ—Å—Ç–æ –æ–±—ã—á–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è ¬´–¥–≤–∏–∂–µ–Ω–∏–µ¬ª –≤—ã –ø–µ—Ä–µ–¥–≤–∏–≥–∞–µ—Ç–µ—Å—å –Ω–∞ 3 –æ–±–ª–∞—Å—Ç–∏ –∏–ª–∏ –º–µ–Ω—å—à–µ –∏ –º–æ–∂–µ—Ç–µ –ø–æ—Ç—Ä–∞—Ç–∏—Ç—å $1, —á—Ç–æ–±—ã –ø–µ—Ä–µ–¥–≤–∏–Ω—É—Ç—å—Å—è –µ—â–µ –Ω–∞ 1 –æ–±–ª–∞—Å—Ç—å.'
    },
    '–ë–µ–∫–∫–∏': {
        type: '–í–µ—â—å ‚Äî –æ—Ä—É–∂–∏–µ',
        description: '–ü–æ–ª—É—á–∏—Ç–µ +4 üí™ –≤ —Ä–∞–º–∫–∞—Ö –¥–µ–π—Å—Ç–≤–∏—è ¬´–∞—Ç–∞–∫–∞¬ª.'
    },
    '–ù–∞—Ä—É—á–Ω–∏–∫–∏': {
        type: '–í–µ—â—å ‚Äî –ø—Ä–æ—Å—Ç–∞—è',
        description: '–†–∞–∑ –≤ —Ä–∞—É–Ω–¥, –ø–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –≤—ã –Ω–∞–Ω–µ—Å–ª–∏ —É—Ä–æ–Ω –Ω–µ–∑–ø–∏—á–µ—Å–∫–æ–º—É –º–æ–Ω—Å—Ç—Ä—É-—á–µ–ª–æ–≤–µ–∫—É, –≤—ã—à–ª–∏ –∏–∑ –±–æ—è —Å —Ç–∞–∫–∏–º –º–æ–Ω—Å—Ç—Ä–æ–º –∏–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ –æ—Ç –Ω–µ–≥–æ —É—Ä–æ–Ω, –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–±–µ–¥–∏—Ç—å —ç—Ç–æ–≥–æ –º–æ–Ω—Å—Ç—Ä–∞.'
    }
};

// –î–∞–Ω–Ω—ã–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
export const characters = {
    agnes: {
        id: 'agnes',
        name: '–ê–≥–Ω–µ—Å –ë–µ–π–∫–µ—Ä',
        role: '–û—Ñ–∏—Ü–∏–∞–Ω—Ç–∫–∞',
        stats: {
            health: 6,
            sanity: 6,
            knowledge: 4,
            influence: 2,
            observation: 2,
            strength: 2,
            will: 3
        },
        focus: 2,
        ability: {
            name: '–ö—Ä–æ–≤–∞–≤—ã–µ —á–∞—Ä—ã',
            description: '–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å —É—Ä–æ–Ω –≤–º–µ—Å—Ç–æ —É–∂–∞—Å–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–π'
        },
        secondaryAbility: {
            name: '–°–∏–ª–∞ –∫—Ä–æ–≤–∏',
            description: '–ï—Å–ª–∏ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ —É—Ä–æ–Ω –∏–ª–∏ —Ç—Ä–∞—Ç–∏—Ç–µ —Ç—Ä–æ—Ñ–µ–∏, –≤—ã –ø–æ–ª—É—á–∞–µ—Ç–µ +2'
        },
        quote: '–ò—Å—Ç–∏–Ω–∞ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ç–∞–∫–æ–≤–∞, –∫–∞–∫–æ–π –∫–∞–∂–µ—Ç—Å—è',
        story: '–ò–∑–¥–∞–≤–Ω–∞ –ê–≥–Ω–µ—Å –º—É—á–∏–ª–∏ —Å–Ω–æ–≤–∏–¥–µ–Ω–∏—è: –ª—é–¥–∏ –≤ –º–∞–Ω—Ç–∏—è—Ö, –ø–µ—Å–Ω–æ–ø–µ–Ω–∏—è, —Ä—ã—á–∞—â–∏–µ –º–æ–Ω—Å—Ç—Ä—ã, –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω–∞ –≤–∏–¥–µ–ª–∞ –∫—Ä–∞–µ–º –≥–ª–∞–∑–∞. –û–¥–Ω–∞–∂–¥—ã –æ–Ω–∞ —É–ø–∞–ª–∞ –∏ —É–¥–∞—Ä–∏–ª–∞—Å—å –≥–æ–ª–æ–≤–æ–π, –∏ —Å —Ç–µ—Ö –ø–æ—Ä —Å–Ω—ã —Å—Ç–∞–ª–∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∫ –Ω–µ–π –Ω–∞—è–≤—É: –∫–∞–∫ –æ–Ω–∞ —Ä—É–∫–æ–≤–æ–¥–∏—Ç –ø–µ–Ω–∏–µ–º –ª—é–¥–µ–π –≤ –º–∞–Ω—Ç–∏—è—Ö, –∫–∞–∫ –æ–Ω–∞ –ø—Ä—è—á–µ—Ç —Å–µ—Ä–µ–±—Ä—è–Ω—ã–π –∫–ª—é—á –≤ –∫–ª–∞–¥–∫–µ –∫–æ–ª–æ–¥—Ü–∞, –∫–∞–∫ –æ–Ω–∞, –±—É–¥—É—á–∏ –≤–æ–ª—à–µ–±–Ω–∏—Ü–µ–π, —Ç–≤–æ—Ä–∏—Ç –∑–∞–∫–ª–∏–Ω–∞–Ω–∏—è –≤ –º–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –ì–∏–ø–µ—Ä–±–æ—Ä–µ–µ. –í –ø–æ–∏—Å–∫–∞—Ö –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ê–≥–Ω–µ—Å –ø—Ä–∏–µ—Ö–∞–ª–∞ –≤ –ê—Ä–∫—Ö—ç–º, —Å–ª–∞–≤—è—â–∏–π—Å—è –ª–µ–≥–µ–Ω–¥–∞–º–∏ –æ —Å—É–¥–∞—Ö –Ω–∞–¥ –≤–µ–¥—å–º–∞–º–∏ –∏ –¥—Ä—É–≥–∏–º–∏ —Å—Ç—Ä–∞–Ω–Ω—ã–º–∏ –∏—Å—Ç–æ—Ä–∏—è–º–∏. –û–Ω–∞ —É—Å—Ç—Ä–æ–∏–ª–∞—Å—å –∫ –í–µ–ª—å–º–µ –∏ –≤—Å–∫–æ—Ä–µ –Ω–∞—à–ª–∞ —Å—Ç–∞—Ä—ã–π –∫–æ–ª–æ–¥–µ—Ü —Å —Ä–∞—Å—à–∞—Ç–∞–Ω–Ω–æ–π –∫–∞–º–µ–Ω–Ω–æ–π –∫–ª–∞–¥–∫–æ–π. –ó–∞ –∫–∞–º–Ω–µ–º –æ–∫–∞–∑–∞–ª—Å—è —Å–ø—Ä—è—Ç–∞–Ω —Å–µ—Ä–µ–±—Ä—è–Ω—ã–π –∫–ª—é—á - –∏ –æ–Ω–∞ —Ç–æ—á–Ω–æ –∑–Ω–∞–ª–∞, –≥–¥–µ –µ–≥–æ –∏—Å–∫–∞—Ç—å.',
        defaultItems: ['–ì–∏–ø–µ—Ä–±–æ—Ä–µ–π—Å–∫–∞—è —Ä–µ–ª–∏–∫–≤–∏—è', '$3'],
        choiceItems: ['–ë—É—Ä—è –¥—É—Ö–æ–≤', '–ó–∞—â–∏—Ç–∞ –ø–ª–æ—Ç–∏']
    },
    tommy: {
        id: 'tommy',
        name: '–¢–æ–º–º–∏ –ú–∞–ª–¥—É–Ω',
        role: '–Æ–Ω—ã–π –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏–π',
        stats: {
            health: 7,
            sanity: 5,
            knowledge: 2,
            influence: 2,
            observation: 3,
            strength: 3,
            will: 3
        },
        focus: 2,
        ability: {
            name: '–û–≥—Ä–∞–¥–∏—Ç—å –æ—Ç –±–µ–¥—ã',
            description: '–ï—Å–ª–∏ –º–æ–Ω—Å—Ç—Ä –¥–æ–ª–∂–µ–Ω –≤—Å—Ç—É–ø–∏—Ç—å –≤ –±–æ–π —Å –¥—Ä—É–≥–∏–º —Å—ã—â–∏–∫–æ–º –≤ –≤–∞—à–µ–π –æ–±–ª–∞—Å—Ç–∏, –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –≤—ã –º–æ–∂–µ—Ç–µ –≤—Å—Ç—É–ø–∏—Ç—å –≤ –±–æ–π —Å —ç—Ç–∏–º –º–æ–Ω—Å—Ç—Ä–æ–º'
        },
        secondaryAbility: {
            name: '–°–ª—É–∂–∏—Ç—å –∏ –∑–∞—â–∏—â–∞—Ç—å',
            description: '–ö–æ–≥–¥–∞ –≤—ã –≤—Å—Ç—É–ø–∞–µ—Ç–µ –≤ –±–æ–π —Å –º–æ–Ω—Å—Ç—Ä–æ–º –≤–º–µ—Å—Ç–æ –¥—Ä—É–≥–æ–≥–æ —Å—ã—â–∏–∫–∞, –ø–æ–ª—É—á–∏—Ç–µ +1 –∫ –ø—Ä–æ–≤–µ—Ä–∫–∞–º –¥–æ –∫–æ–Ω—Ü–∞ –±–æ—è'
        },
        quote: '–ù—É —á—Ç–æ, –¢–æ–º–º–∏. –í—Ä–µ–º—è —Å—Ç–∞—Ç—å –≥–µ—Ä–æ–µ–º',
        story: '–í —Å–µ–º—å–µ –ú–∞–ª–¥—É–Ω–æ–≤ –±—ã–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∫–æ–ª–µ–Ω–∏–π –ø–æ–ª–∏—Ü–µ–π—Å–∫–∏—Ö, –∏ –¢–æ–º–º–∏ –Ω–µ —Å—Ç–∞–ª –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º. –ó–∞–∫–æ–Ω—á–∏–≤ –∞–∫–∞–¥–µ–º–∏—é –≤ –ë–æ—Å—Ç–æ–Ω–µ, –æ–Ω —Å—Ç–∞–ª –≥–æ—Ä–¥–æ—Å—Ç—å—é —Å–≤–æ–µ–π —Å–µ–º—å–∏. –¢–∞–∫ —á—Ç–æ, –∫–æ–≥–¥–∞ –¢–æ–º–º–∏ –Ω–∞–∑–Ω–∞—á–∏–ª–∏ –≤ –ø–æ–ª–∏—Ü–∏—é –ê—Ä–∫—Ö—ç–º–∞, –æ–Ω —Ä–∞—Å—Å—Ç—Ä–æ–∏–ª—Å—è: –≤ –∫–æ–Ω—Ü–µ –∫–æ–Ω—Ü–æ–≤, –∫—É–¥–∞ –ê—Ä–∫—Ö—ç–º—É –¥–æ —Å–ª—É—á–∞–µ–≤ –∏ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –±–æ–ª—å—à–æ–≥–æ –≥–æ—Ä–æ–¥–∞, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –æ–Ω –±—ã —Ä–∞–±–æ—Ç–∞–ª –≤ –ë–æ—Å—Ç–æ–Ω–µ? –û–¥–Ω–∞–∫–æ —Ä–∞–±–æ—Ç–∞ –≤ –ê—Ä–∫—Ö—ç–º–µ —Ç–æ–∂–µ –æ–∫–∞–∑–∞–ª–∞—Å—å –ø–æ-—Å–≤–æ–µ–º—É –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–π. –î–µ–ª–∞ –∑–¥–µ—Å—å, –æ—á–µ–≤–∏–¥–Ω–æ, –æ–±—Å—Ç–æ—è–ª–∏ —Å—Ç—Ä–∞–Ω–Ω–æ, –∏, –ø–æ—Ö–æ–∂–µ, –º–µ—Å—Ç–Ω–æ–π –ø–æ–ª–∏—Ü–∏–∏ –±—ã–ª–æ –ø—Ä–æ—â–µ –¥–µ–ª–∞—Ç—å –≤–∏–¥, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, —á–µ–º –∏—Å–ø—Ä–∞–≤–ª—è—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é. –¢–∞–∫ —á—Ç–æ –¢–æ–º–º–∏, –≤–æ–æ—Ä—É–∂–∏–≤—à–∏—Å—å –¥–µ–¥—É—à–∫–∏–Ω—ã–º —Ä—É–∂—å—ë–º –ø–æ –ø—Ä–æ–∑–≤–∏—â—É –ë–µ–∫–∫–∏, —Ä–µ—à–∏–ª –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –æ–¥–∏–Ω–æ—á–∫—É.',
        defaultItems: ['–ë–µ–∫–∫–∏', '$2'],
        choiceItems: ['–ù–∞—Ä—É—á–Ω–∏–∫–∏', '–ú–æ—Ç–æ—Ü–∏–∫–ª']
    }
};

// –î–∞–Ω–Ω—ã–µ –º–æ–Ω—Å—Ç—Ä–æ–≤
export const monsters = {
    "blindWatcher": createMonster({
        name: "–ë–µ–∑–≥–ª–∞–∑—ã–π –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å",
        monsterType: "WATCHER",
        activation: MONSTER_ACTIVATIONS.PURSUE
    }),
    
    "cultist": createMonster({
        name: "–ö—É–ª—å—Ç–∏—Å—Ç",
        monsterType: "CULTIST",
        activation: MONSTER_ACTIVATIONS.ADD_DESPAIR
    })
}; 